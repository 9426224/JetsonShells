Sending build context to Docker daemon    660kB
Step 1/27 : ARG BASE_IMAGE=nvcr.io/nvidia/deepstream-l4t:5.0.1-20.09-samples
Step 2/27 : FROM ${BASE_IMAGE}
 ---> 3b30b2543266
Step 3/27 : LABEL maintainer="9426224"     version="0.1"     description="A l4t-base dockerfile for ROS2 User"     email="9426224@live.com"
 ---> Using cache
 ---> bf99e860b005
Step 4/27 : ENV DEBIAN_FRONTEND=noninteractive
 ---> Using cache
 ---> 5d898c1174ab
Step 5/27 : ENV SHELL /bin/bash
 ---> Using cache
 ---> 196477e8568a
Step 6/27 : SHELL ["/bin/bash", "-c"]
 ---> Using cache
 ---> 1f77a1cde147
Step 7/27 : WORKDIR /tmp
 ---> Using cache
 ---> dd4c9e673d8f
Step 8/27 : RUN locale-gen en_US en_US.UTF-8 && update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8
 ---> Using cache
 ---> 3d0b74cb405c
Step 9/27 : ENV LANG=en_US.UTF-8
 ---> Using cache
 ---> f08e28be4b4d
Step 10/27 : ENV PYTHONIOENCODING=utf-8
 ---> Using cache
 ---> 0bc53cc83b19
Step 11/27 : RUN apt-get update &&     apt-get install -y --no-install-recommends         curl         wget         gnupg2         lsb-release         ca-certificates         build-essential         git         openssh-server         vim         apt-utils         usbutils         iputils-ping         gdb         libtool         autoconf         automake         unzip         tmux &&     rm -rf /var/lib/apt/lists/* &&     apt-get clean &&     curl -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg &&     echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu $(lsb_release -cs) main" | tee /etc/apt/sources.list.d/ros2.list > /dev/null &&     rm -rf /tmp/*
 ---> Using cache
 ---> 049e30917c95
Step 12/27 : RUN wget --quiet --show-progress --progress=bar:force:noscroll --no-check-certificate          https://github.com/Kitware/CMake/releases/download/v3.20.5/cmake-3.20.5-linux-aarch64.tar.gz &&    tar -zxvf ./cmake-3.20.5-linux-aarch64.tar.gz -C /usr/local/share/ &&     ln -s /usr/local/share/cmake-3.20.5-linux-aarch64/bin/cmake /usr/bin/cmake &&     ln -s /usr/local/share/cmake-3.20.5-linux-aarch64/bin/cmake /usr/local/bin/cmake &&     rm -rf /tmp/*
 ---> Using cache
 ---> bc9fc77c51ac
Step 13/27 : RUN apt-get update &&     apt-get install -y --no-install-recommends         libbullet-dev         libpython3-dev         python3-colcon-common-extensions         python3-flake8         python3-pip         python3-numpy         python3-pytest-cov         python3-rosdep         python3-setuptools         python3-vcstool         python3-rosinstall-generator         libasio-dev         libtinyxml2-dev         libcunit1-dev         libopenblas-base         libopenmpi-dev         libopenblas-dev         libatlas-base-dev         gfortran         liblapack-dev         libboost-python-dev         libboost-thread-dev         libcurl4-openssl-dev         libgstreamer1.0-dev         libgstreamer-plugins-base1.0-dev         libssl1.0.0         libgstreamer1.0-0         gstreamer1.0-tools         gstreamer1.0-plugins-good         gstreamer1.0-plugins-bad         gstreamer1.0-plugins-ugly         gstreamer1.0-libav         libgstrtspserver-1.0-0         libjansson4         libx11-dev         x11-apps         xorg         meson         libfreetype6-dev         python3-matplotlib         python3-numba         python3-llvmlite         tcl-dev         tk-dev         python3-tk         protobuf-compiler         libprotoc-dev &&     rm -rf /var/lib/apt/lists/* &&     apt-get clean &&     rm -rf /tmp/*
 ---> Using cache
 ---> bfb70c4bb482
Step 14/27 : RUN pip3 install --upgrade pip &&     python3 -m pip install --no-cache-dir -U         wheel         Cython         setuptools         numpy==1.19.3 &&     python3 -m pip install --no-cache-dir -U         argcomplete         flake8-blind-except         flake8-builtins         flake8-class-newline         flake8-comprehensions         flake8-deprecated         flake8-docstrings         flake8-import-order         flake8-quotes         pytest-repeat         pytest-rerunfailures         pytest         pyzmq         pycuda==2019.1.2         filterpy==1.4.5         scikit-learn==0.24.2         scikit-image==0.17.2         scipy==1.5.4         pandas         pillow         onnx==1.4.1 &&     rm -rf /tmp/* &&     rm -rf ~/.cache/pip
 ---> Using cache
 ---> 4311dea700dd
Step 15/27 : RUN ln -s /usr/local/cuda-10.2/targets/aarch64-linux/lib/libcudart.so.10.2 /usr/lib/aarch64-linux-gnu/ &&     ln -s /usr/local/cuda-10.2/targets/aarch64-linux/lib/libnvrtc.so /usr/lib/aarch64-linux-gnu/ &&     ln -s /usr/local/cuda-10.2/targets/aarch64-linux/lib/libnvrtc.so.10.2 /usr/lib/aarch64-linux-gnu/ &&     ln -s /usr/local/cuda-10.2/targets/aarch64-linux/lib/libnvrtc-builtins.so /usr/lib/aarch64-linux-gnu/ &&     ln -s /usr/local/cuda-10.2/targets/aarch64-linux/lib/libcudart.so.10.2.89 /usr/lib/aarch64-linux-gnu/ &&     ln -s /usr/local/cuda-10.2/targets/aarch64-linux/lib/libcurand.so.10 /usr/lib/aarch64-linux-gnu/ &&     ln -s $(which nvcc) /sbin/nvcc
 ---> Using cache
 ---> 1d2826a00282
Step 16/27 : RUN git clone --branch yaml-cpp-0.7.0 https://github.com/jbeder/yaml-cpp yaml-cpp-0.7 &&     cd yaml-cpp-0.7 &&     mkdir build &&     cd build &&     cmake -DBUILD_SHARED_LIBS=ON .. &&     make -j$(nproc) &&     make -j$(nproc) install &&     git clone https://github.com/open-source-parsers/jsoncpp.git &&     cd jsoncpp &&     mkdir build &&     cd build &&     cmake .. &&     make -j$(nproc) &&     make -j$(nproc) install &&     rm -rf /tmp/*
 ---> Using cache
 ---> 77a292ec9065
Step 17/27 : RUN apt-get purge -y '*opencv*' || echo "previous OpenCV installation not found" &&     mkdir opencv &&     cd opencv &&     wget --quiet --show-progress --progress=bar:force:noscroll --no-check-certificate https://nvidia.box.com/shared/static/5v89u6g5rb62fpz4lh0rz531ajo2t5ef.gz -O OpenCV-4.5.0-aarch64.tar.gz &&     tar -xzvf OpenCV-4.5.0-aarch64.tar.gz &&     dpkg -i --force-depends *.deb &&     apt-get update &&     apt-get install -y -f --no-install-recommends &&     dpkg -i *.deb &&     rm -rf /var/lib/apt/lists/* &&     apt-get clean &&     rm -rf /tmp/* &&     cp -r /usr/include/opencv4 /usr/local/include/opencv4 &&     cp -r /usr/lib/python3.6/dist-packages/cv2 /usr/local/lib/python3.6/dist-packages/cv2
 ---> Using cache
 ---> 0c47ffaba731
Step 18/27 : RUN wget --quiet --show-progress --progress=bar:force:noscroll --no-check-certificate         https://nvidia.box.com/shared/static/cs3xn3td6sfgtene6jdvsxlr366m2dhq.whl -O torch-1.7.0-cp36-cp36m-linux_aarch64.whl &&     pip3 install --no-cache-dir torch-1.7.0-cp36-cp36m-linux_aarch64.whl &&     rm -rf ~/.cache/pip &&     rm -rf /tmp/*
 ---> Using cache
 ---> 2c3baf101419
Step 19/27 : RUN mkdir -p /opt/ros/foxy/src &&     cd /opt/ros/foxy &&     rosinstall_generator --deps --rosdistro foxy ros_base         launch_xml         launch_yaml         launch_testing         launch_testing_ament_cmake         demo_nodes_cpp         demo_nodes_py         example_interfaces         camera_calibration_parsers         camera_info_manager         cv_bridge         v4l2_camera         vision_opencv         vision_msgs         image_geometry         image_pipeline         image_transport         compressed_image_transport         compressed_depth_image_transport     > ros2.foxy.ros_base.rosinstall &&     cat ros2.foxy.ros_base.rosinstall &&     vcs import src < ros2.foxy.ros_base.rosinstall &&     rm ./src/libyaml_vendor/CMakeLists.txt &&     wget --no-check-certificate https://raw.githubusercontent.com/ros2/libyaml_vendor/master/CMakeLists.txt -P ./src/libyaml_vendor/ &&     apt-get update &&     cd /opt/ros/foxy &&     rosdep init &&     rosdep update &&     rosdep install -y         --ignore-src         --from-paths src         --rosdistro foxy         --skip-keys "libopencv-dev libopencv-contrib-dev libopencv-imgproc-dev python-opencv python3-opencv" &&     colcon build --merge-install &&     rm -rf /opt/ros/foxy/src &&     rm -rf /opt/ros/foxy/log &&     rm -rf /opt/ros/foxy/build &&     rm /opt/ros/foxy/*.rosinstall &&     rm -rf /var/lib/apt/lists/* &&     apt-get clean &&     rm -rf /tmp/*
 ---> Using cache
 ---> 678308e6802e
Step 20/27 : ENV RMW_IMPLEMENTATION=rmw_cyclonedds_cpp
 ---> Using cache
 ---> f09a27f3131c
Step 21/27 : RUN wget --quiet --show-progress --progress=bar:force:noscroll --no-check-certificate         https://nodejs.org/dist/v14.17.5/node-v14.17.5-linux-arm64.tar.xz &&     tar -xvf node-v14.17.5-linux-arm64.tar.xz &&     mv node-v14.17.5-linux-arm64 /opt/node &&     ln -s /opt/node/bin/node /usr/local/bin/node &&     ln -s /opt/node/bin/npm /usr/local/bin/npm &&     npm install -g pm2 &&     ln -s /opt/node/bin/pm2 /usr/local/bin/ &&     rm -rf /tmp/*
 ---> Using cache
 ---> 887ef656ce59
Step 22/27 : RUN wget  --quiet --show-progress --progress=bar:force:noscroll --no-check-certificate     https://github.com/cdr/code-server/releases/download/v3.11.1/code-server-3.11.1-linux-arm64.tar.gz &&     tar -zxvf code-server-3.11.1-linux-arm64.tar.gz &&     mv code-server-3.11.1-linux-arm64 ~/code-server &&     rm -rf /tmp/*
 ---> Using cache
 ---> 12b89204eb94
Step 23/27 : RUN echo $'#!/bin/bash\n     set -e\n     echo "root:$rootpwd" | chpasswd\n     /etc/init.d/ssh start\n     export PASSWORD=$cspwd\n     echo port=${sshport} >> /etc/ssh/sshd_config\n     /etc/init.d/ssh restart\n     nohup /root/code-server/code-server --port $csport --auth password --host 0.0.0.0 >& /root/code-server/run.log &\n     echo -e export\tDISPLAY=$DISPLAY >> /root/.bashrc\n     exec "$@"' > /ros_entrypoint.sh &&     chmod +x /ros_entrypoint.sh &&     echo $'export XAUTHORITY=/tmp/.XAuthority\nsource /opt/ros/foxy/install/setup.bash\nsource /ros2_ws/install/setup.bash' >> /root/.bashrc &&     echo $'PermitRootLogin yes\nPubkeyAuthentication yes\nAllowTcpForwarding yes\nX11DisplayOffset 10\nX11UseLocalhost yes' >> /etc/ssh/sshd_config
 ---> Running in 023d5d24cd80
Removing intermediate container 023d5d24cd80
 ---> 9a0d96727979
Step 24/27 : RUN mkdir -p ~/ros2_ws/src
 ---> Running in aa32db5a7c56
Removing intermediate container aa32db5a7c56
 ---> 0349868896fd
Step 25/27 : ENTRYPOINT ["/ros_entrypoint.sh"]
 ---> Running in 57679b9bd112
Removing intermediate container 57679b9bd112
 ---> 9d7a67c3b9df
Step 26/27 : CMD ["bash"]
 ---> Running in a1a35ee2a6df
Removing intermediate container a1a35ee2a6df
 ---> b2a62f8cb570
Step 27/27 : WORKDIR /root/
 ---> Running in 1f17dca2878f
Removing intermediate container 1f17dca2878f
 ---> 9993c2d014fa
Successfully built 9993c2d014fa
Successfully tagged vps.9426224.xyz:8502/ros-foxy-deepstream-5.0.1-sample:latest
